# üìã Zen Task API

> Modern task management REST API built with NestJS, Bun, PostgreSQL, and Prisma ORM

## üéØ Overview

A secure and scalable task management API designed for personal productivity and team collaboration. Built with modern TypeScript stack focusing on type safety, security by default, and developer experience.

**Current Status:** MVP Complete ‚Äî 6 core modules implemented (86% of planned features)

## ‚ú® Features

### Core Functionality

- üîê **Authentication & Authorization**
  - JWT access + refresh tokens
  - HTTP-only cookies for secure token storage
  - Role-based access control (OWNER, ADMIN, MEMBER, VIEWER)
  - Argon2id password hashing

- üìä **Project Management**
  - Multi-user projects with membership system
  - Project roles and permissions (owner, admin, member, viewer)
  - Favorite and hidden projects
  - Auto-generated slugs for SEO-friendly URLs

- ‚úÖ **Task Management**
  - 8 task statuses (NOT_STARTED, IN_PROGRESS, COMPLETED, etc.)
  - Task assignments to team members
  - Due dates with overdue tracking
  - Task notes and descriptions
  - Advanced filtering (10+ parameters)

- üè∑Ô∏è **Categories & Markers**
  - Task categorization with auto-generated slugs
  - Default markers available to all users (read-only)
  - Personal markers with custom colors (hex validation)
  - Multiple markers per task (many-to-many)

- üìà **Statistics & Analytics**
  - Real-time dashboard metrics
  - Task completion rates and trends
  - Productivity tracking (daily/weekly)
  - Project activity overview

### Technical Features

- ‚ö° **High Performance** - Bun runtime (faster than Node.js)
- üõ°Ô∏è **Security First** - Input validation, SQL injection protection, no sensitive data in responses
- üìù **Type Safety** - Strict TypeScript, Prisma ORM for type-safe database queries
- üìö **API Documentation** - Interactive Swagger UI at `/api/docs`
- üé® **Clean Architecture** - Modular structure, dependency injection, separation of concerns
- üîÑ **Developer Experience** - Hot reload, auto-formatting, centralized constants

## üõ†Ô∏è Tech Stack

| Layer          | Technology                          | Purpose                            |
| -------------- | ----------------------------------- | ---------------------------------- |
| **Runtime**    | Bun 1.x                             | Fast JavaScript runtime            |
| **Framework**  | NestJS 10.x                         | Enterprise-grade Node.js framework |
| **Language**   | TypeScript 5.x                      | Type-safe development              |
| **Database**   | PostgreSQL (Neon)                   | Serverless PostgreSQL              |
| **ORM**        | Prisma 6.x                          | Type-safe database client          |
| **Auth**       | JWT + Passport                      | Secure authentication              |
| **Validation** | class-validator + class-transformer | Request/response validation        |
| **Docs**       | Swagger/OpenAPI                     | Interactive API documentation      |
| **Hashing**    | Argon2id                            | Secure password hashing            |

## üì¶ Implemented Modules

| Module    | Description                                  | Endpoints | Status       |
| --------- | -------------------------------------------- | --------- | ------------ |
| Auth      | Registration, login, JWT, refresh tokens     | 5         | ‚úÖ Complete  |
| Project   | Project CRUD, membership, role-based access  | 9         | ‚úÖ Complete  |
| Task      | Task CRUD, statuses, assignments, markers    | 9         | ‚úÖ Complete  |
| Category  | Category CRUD, slug generation               | 6         | ‚úÖ Complete  |
| Marker    | Marker CRUD, default/personal, custom colors | 6         | ‚úÖ Complete  |
| Statistic | Real-time analytics, dashboard metrics       | 1         | ‚úÖ Complete  |
| Contact   | Contact management                           | 0         | ‚è∏Ô∏è Postponed |

**Total API Endpoints:** 36

## üèóÔ∏è Architecture

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   Client    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ HTTP/REST
       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ           NestJS Application            ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îÇ
‚îÇ  ‚îÇ        Controllers              ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  (Routes + Validation)          ‚îÇ   ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ
‚îÇ             ‚îÇ                           ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îÇ
‚îÇ  ‚îÇ    Guards & Decorators          ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  (@Auth, @CurrentUser, etc.)    ‚îÇ   ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ
‚îÇ             ‚îÇ                           ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îÇ
‚îÇ  ‚îÇ         Services                ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ    (Business Logic)             ‚îÇ   ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ
‚îÇ             ‚îÇ                           ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îÇ
‚îÇ  ‚îÇ      Prisma Service             ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ   (Database Abstraction)        ‚îÇ   ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
              ‚îÇ
       ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
       ‚îÇ  PostgreSQL  ‚îÇ
       ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### Key Principles

- **Type Safety First** - Strict TypeScript, no `any` types
- **Security by Default** - Validation on all inputs, explicit field selection
- **Modular Architecture** - Singular module naming (project, task, not projects)
- **Centralized Constants** - No hardcoded strings (apiTags, controllerPaths, etc.)
- **Global Modules** - PrismaService available everywhere via DI
- **Explicit Field Selection** - Never return passwords or sensitive data

## üöÄ Quick Start

### Prerequisites

- [Bun](https://bun.sh) >= 1.0
- PostgreSQL >= 14 (or [Neon](https://neon.tech) account for serverless PostgreSQL)
- Git

### Installation

```bash
# Clone repository
git clone <repository-url>
cd zt-server

# Install dependencies
bun install

# Configure environment
cp .env.example .env
# Edit .env with your DATABASE_URL and JWT_SECRET

# Setup database
bun run prisma:generate
bun run prisma:migrate

# Start development server
bun run start:dev
```

Server will start at `http://localhost:4000`

### Environment Variables

Required variables in `.env`:

```env
# Database (Neon serverless PostgreSQL)
DATABASE_URL="postgresql://user:password@ep-xxx.region.aws.neon.tech/zentask?sslmode=require"
# Or local PostgreSQL:
# DATABASE_URL="postgresql://user:password@localhost:5432/zentask"

# JWT
JWT_SECRET="your-secret-key-min-32-chars"
JWT_ACCESS_EXPIRES="15m"
JWT_REFRESH_EXPIRES="7d"

# Application
NODE_ENV="development"
PORT=4000

# Cookies
COOKIE_DOMAIN="localhost"
```

## üìö API Documentation

### üìñ Interactive Swagger UI

**URL:** `http://localhost:4000/api/docs`

Interactive API documentation with the following features:

- üß™ **Try it out** - Test all endpoints directly from browser
- üìù **Request/Response schemas** - View detailed data structures
- üîê **Authentication** - Authorize with JWT tokens (click "Authorize" button)
- üè∑Ô∏è **Module grouping** - Endpoints organized by tags (auth, projects, tasks, etc.)
- üìã **Examples** - Pre-filled examples for all request bodies
- üîç **Search & filter** - Find endpoints quickly

**Quick Start with Swagger:**

1. Start the server: `bun run start:dev`
2. Open `http://localhost:4000/api/docs` in browser
3. Register a new user via `POST /auth/register`
4. Copy the `accessToken` from response
5. Click "Authorize" button at the top
6. Paste token and click "Authorize"
7. Try out any protected endpoint!

### API Endpoints Overview

**Auth (5 endpoints)**

- `POST /auth/register` - Create new account
- `POST /auth/login` - Login to existing account
- `POST /auth/refresh` - Refresh access token
- `POST /auth/logout` - Logout and invalidate tokens
- `GET /auth/profile` - Get current user profile

**Projects (9 endpoints)**

- `GET /projects` - List all projects (with pagination)
- `GET /projects/:id` - Get project by ID
- `GET /projects/slug/:slug` - Get project by slug
- `POST /projects` - Create new project
- `PATCH /projects/:id` - Update project
- `DELETE /projects/:id` - Delete project
- `POST /projects/:id/members` - Add member to project
- `DELETE /projects/:id/members/:memberId` - Remove member
- `PATCH /projects/:id/members/:memberId/role` - Update member role

**Tasks (9 endpoints)**

- `GET /tasks` - List all tasks (with filters)
- `GET /tasks/:id` - Get task by ID
- `POST /tasks` - Create new task
- `PATCH /tasks/:id` - Update task
- `DELETE /tasks/:id` - Delete task
- `PATCH /tasks/:id/status` - Update task status
- `PATCH /tasks/:id/assign` - Assign/unassign user
- `POST /tasks/:id/markers/:markerId` - Add marker to task
- `DELETE /tasks/:id/markers/:markerId` - Remove marker

**Categories (6 endpoints)**

- `GET /categories` - List categories
- `GET /categories/:id` - Get category by ID
- `GET /categories/slug/:slug` - Get category by slug
- `POST /categories` - Create category
- `PATCH /categories/:id` - Update category
- `DELETE /categories/:id` - Delete category

**Markers (6 endpoints)**

- `GET /markers` - List markers (default + personal)
- `GET /markers/:id` - Get marker by ID
- `GET /markers/slug/:slug` - Get marker by slug
- `POST /markers` - Create personal marker
- `PATCH /markers/:id` - Update personal marker
- `DELETE /markers/:id` - Delete personal marker

**Statistics (1 endpoint)**

- `GET /statistics/overview` - Get user statistics dashboard

## üìÇ Project Structure

```
zt-server/
‚îú‚îÄ‚îÄ prisma/
‚îÇ   ‚îú‚îÄ‚îÄ schema.prisma       # Database schema
‚îÇ   ‚îî‚îÄ‚îÄ migrations/         # Database migrations
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ main.ts             # Application entry point
‚îÇ   ‚îú‚îÄ‚îÄ app.module.ts       # Root module
‚îÇ   ‚îú‚îÄ‚îÄ modules/            # Feature modules (singular naming!)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth/           # Authentication & authorization
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ project/        # Project management
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ task/           # Task management
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ category/       # Categories
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ marker/         # Markers/labels
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ statistic/      # Statistics & analytics
‚îÇ   ‚îú‚îÄ‚îÄ prisma/             # Global Prisma module
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ prisma.service.ts
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ prisma.module.ts
‚îÇ   ‚îî‚îÄ‚îÄ shared/             # Shared utilities
‚îÇ       ‚îú‚îÄ‚îÄ config/         # Configuration (JWT, Swagger)
‚îÇ       ‚îú‚îÄ‚îÄ constants/      # App constants (no hardcoded strings!)
‚îÇ       ‚îú‚îÄ‚îÄ dto/            # Base DTOs (PaginationQueryDto)
‚îÇ       ‚îú‚îÄ‚îÄ types/          # Shared types
‚îÇ       ‚îî‚îÄ‚îÄ utils/          # Utilities (pagination, slug generation)
‚îú‚îÄ‚îÄ test/                  # E2E tests
‚îî‚îÄ‚îÄ README.md              # This file
```

### Module Structure (Singular Naming!)

Each module follows consistent structure:

```
modules/{entity}/              # ‚ö†Ô∏è Singular: project, task, NOT projects!
‚îú‚îÄ‚îÄ {entity}.module.ts         # NestJS module
‚îú‚îÄ‚îÄ {entity}.controller.ts     # REST controller
‚îú‚îÄ‚îÄ {entity}.service.ts        # Business logic
‚îú‚îÄ‚îÄ index.ts                   # Public API exports
‚îú‚îÄ‚îÄ README.md                  # Module documentation
‚îú‚îÄ‚îÄ dto/                       # Data Transfer Objects
‚îú‚îÄ‚îÄ types/                     # TypeScript types
‚îú‚îÄ‚îÄ constants/                 # Messages & Swagger schemas
‚îî‚îÄ‚îÄ decorators/                # Swagger decorators
```

**Note:** URLs remain plural (`/projects`, `/tasks`) following REST conventions.

## üíª Development Commands

```bash
# Development
bun run start:dev          # Start dev server with watch mode
bun run build              # Build for production
bun run start:prod         # Run production build

# Database
bun run prisma:generate    # Generate Prisma Client types
bun run prisma:migrate     # Create and apply migration
bun run prisma:studio      # Open Prisma Studio (database GUI)
bun run prisma:db:push     # Push schema without migration (dev only)

# Code Quality
bunx eslint --fix "src/**/*.ts"  # Auto-fix linting issues
bun run format             # Format code with Prettier
```

## üóÑÔ∏è Database Schema

### Core Models

- **User** - Users with roles and authentication
- **Project** - Projects with membership system
- **Membership** - User-project relationships with roles
- **Task** - Tasks with statuses, assignments, and deadlines
- **Category** - Task categories with slugs
- **Marker** - Task markers/labels (default + personal)
- **Contact** - Contacts and team members (planned)
- **Session** - Refresh token sessions

### Key Relations

```
User ‚îÄ‚îÄ[owner]‚îÄ‚îÄ> Project
User ‚îÄ‚îÄ[member]‚îÄ> Membership <‚îÄ[project]‚îÄ‚îÄ Project
User ‚îÄ‚îÄ[creator]‚îÄ> Task
User ‚îÄ‚îÄ[assignee]‚îÄ> Task
Project ‚îÄ‚îÄ[has many]‚îÄ‚îÄ> Task
Task ‚îÄ‚îÄ[has one]‚îÄ‚îÄ> Category
Task ‚îÄ‚îÄ[many-to-many]‚îÄ‚îÄ> Marker
```

**Database Tool:** Prisma Studio available at `http://localhost:5555` (run `bun run prisma:studio`)

## üîí Security

### Implemented Security Measures

- ‚úÖ **Argon2id Password Hashing** - Most secure hashing algorithm
- ‚úÖ **JWT Access Tokens** - Short-lived (15 minutes)
- ‚úÖ **Refresh Tokens** - Long-lived (7 days) in HTTP-only cookies
- ‚úÖ **Role-Based Access Control** - User and project-level roles
- ‚úÖ **Input Validation** - class-validator on all DTOs
- ‚úÖ **SQL Injection Protection** - Prisma parameterized queries
- ‚úÖ **Explicit Field Selection** - Never expose passwords in API responses
- ‚úÖ **CORS Configuration** - Configurable allowed origins

### Best Practices

- All endpoints require authentication (except register/login)
- Sensitive data (passwords, tokens) never returned in responses
- Access control at service level (not just route guards)
- Environment variables for all secrets (never hardcoded)

## üö¢ Deployment

### Production Build

```bash
# Build the application
bun run build

# Run production server
bun run start:prod
```

### Environment Setup

Ensure all required environment variables are set:

```bash
NODE_ENV=production
DATABASE_URL=<neon-database-url>
JWT_SECRET=<secure-secret-min-32-chars>
COOKIE_DOMAIN=<your-domain>
```

### Recommended Platforms

- **Database:** [Neon](https://neon.tech) - Serverless PostgreSQL
- **Hosting:** Railway, Render, Vercel, AWS, DigitalOcean
- **Monitoring:** Sentry for error tracking

## üõ£Ô∏è Roadmap

### ‚úÖ Phase 1: MVP (Complete)

- Auth, Project, Task, Category, Marker, Statistic modules

### üîú Phase 2: Enhanced Features (Planned)

- üí¨ Comments on tasks
- üìé File attachments
- üîî Notifications system
- üîó External integrations (GitHub, Slack)

### üîÆ Future Phases

- WebSockets for real-time updates
- Advanced analytics and reports
- Team collaboration features
- Mobile API optimization

## üìù Code Standards

### Naming Conventions

- **Modules:** Singular form (`project`, `task`, NOT `projects`)
- **URLs:** Plural form (`/projects`, `/tasks`)
- **Files:** kebab-case (`auth.service.ts`)
- **Classes:** PascalCase (`AuthService`)
- **Variables:** camelCase (`userId`)
- **Constants:** UPPER_SNAKE_CASE or camelCase + `as const`

### No Hardcoded Strings!

```typescript
// ‚úÖ Good - use constants
import { apiTags, controllerPaths, routeParams } from '@/shared/constants';

@ApiTags(apiTags.projects)
@Controller(controllerPaths.projects)
export class ProjectController {
  @Get(':id')
  findOne(@Param(routeParams.id) id: string) {}
}

// ‚ùå Bad - hardcoded strings
@ApiTags('projects')
@Controller('projects')
export class ProjectController {
  @Get(':id')
  findOne(@Param('id') id: string) {}
}
```

## ü§ù Contributing

### Development Guidelines

1. **Naming:** Use singular naming for modules (`task`, not `tasks`)
2. **Code Style:** Run `bunx eslint --fix "src/**/*.ts"` before committing
3. **Language:** All code and comments must be in English
4. **Documentation:** Update module README and Swagger for new features
5. **Constants:** Never use hardcoded strings (use `apiTags`, `controllerPaths`, etc.)
6. **Types:** Strict TypeScript, no `any` types
7. **Security:** Always use explicit field selection in Prisma queries

## üìÑ License

[MIT License](LICENSE) - see the [LICENSE](LICENSE) file for details.

This project is a personal pet-project for learning and portfolio purposes.

## üîó Resources

- [NestJS Documentation](https://docs.nestjs.com)
- [Prisma Documentation](https://www.prisma.io/docs)
- [Bun Documentation](https://bun.sh/docs)
- [Neon PostgreSQL](https://neon.tech)

---

**Version:** 1.4.0  
**Last Updated:** 2025-01-12  
**Author:** zim89  
**Status:** MVP Complete ‚úÖ
